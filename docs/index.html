<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管件价格查询系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .select-focus {
                @apply border-primary ring-2 ring-primary/20;
            }
            .transition-all-300 {
                @apply transition-all duration-300;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- 页面标题 -->
        <header class="mb-8 text-center">
            <h1 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-gray-800 mb-2">管件价格查询系统</h1>
            <p class="text-gray-500">六级联动查询，快速获取管件价格信息</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- 左侧查询区域 -->
            <div class="lg:col-span-2 space-y-6">
                <!-- 查询表单 -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                        <i class="fa fa-search text-primary mr-2"></i>
                        管件参数查询
                    </h2>
                    
                    <form id="queryForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- 1. 标准类型 -->
                        <div class="space-y-2">
                            <label for="standard" class="block text-sm font-medium text-gray-700">
                                <span class="text-primary font-bold">1.</span> 标准类型
                            </label>
                            <select id="standard" name="standard" required
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:select-focus transition-all-300 appearance-none bg-white"
                            >
                                <option value="">请选择标准类型</option>
                                <option value="日标">日标</option>
                                <option value="英制">英制</option>
                                <option value="DN">DN</option>
                            </select>
                        </div>

                        <!-- 2. 管件类型 -->
                        <div class="space-y-2">
                            <label for="pipeType" class="block text-sm font-medium text-gray-700">
                                <span class="text-primary font-bold">2.</span> 管件类型
                            </label>
                            <select id="pipeType" name="pipeType" disabled required
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:select-focus transition-all-300 appearance-none bg-gray-50 cursor-not-allowed"
                            >
                                <option value="">请先选择标准类型</option>
                            </select>
                        </div>

                        <!-- 3. 钢材类型 -->
                        <div class="space-y-2">
                            <label for="steelType" class="block text-sm font-medium text-gray-700">
                                <span class="text-primary font-bold">3.</span> 钢材类型
                            </label>
                            <select id="steelType" name="steelType" disabled required
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:select-focus transition-all-300 appearance-none bg-gray-50 cursor-not-allowed"
                            >
                                <option value="">请先选择管件类型</option>
                            </select>
                        </div>

                        <!-- 4. 外径规格 -->
                        <div class="space-y-2">
                            <label for="outerDiameter" class="block text-sm font-medium text-gray-700">
                                <span class="text-primary font-bold">4.</span> 外径规格
                                <span class="ml-2 reducer-tag text-xs text-blue-500 cursor-help">
                                    <i class="fa fa-info-circle mr-1"></i>大小头格式说明
                                </span>
                            </label>
                            <select id="outerDiameter" name="outerDiameter" disabled required
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:select-focus transition-all-300 appearance-none bg-gray-50 cursor-not-allowed"
                            >
                                <option value="">请先选择钢材类型</option>
                            </select>
                        </div>

                        <!-- 5. 规格（有缝/无缝） -->
                        <div class="space-y-2">
                            <label for="specification" class="block text-sm font-medium text-gray-700">
                                <span class="text-primary font-bold">5.</span> 规格
                            </label>
                            <select id="specification" name="specification" disabled required
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:select-focus transition-all-300 appearance-none bg-gray-50 cursor-not-allowed"
                            >
                                <option value="">请先选择外径规格</option>
                            </select>
                        </div>

                        <!-- 6. 壁厚规格 -->
                        <div class="space-y-2">
                            <label for="wallThickness" class="block text-sm font-medium text-gray-700">
                                <span class="text-primary font-bold">6.</span> 壁厚规格 (mm)
                            </label>
                            <select id="wallThickness" name="wallThickness" disabled required
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:select-focus transition-all-300 appearance-none bg-gray-50 cursor-not-allowed"
                            >
                                <option value="">请先选择规格</option>
                            </select>
                        </div>
                    </form>

                    <!-- 价格显示区域 -->
                    <div class="col-span-1 md:col-span-2 lg:col-span-3 mt-6">
                        <div id="priceDisplay" class="p-6 bg-primary/5 rounded-lg border border-primary/20 hidden">
                            <div class="flex flex-col md:flex-row md:items-center justify-between">
                                <div>
                                    <p class="text-gray-500">当前选择的管件单价</p>
                                    <p class="text-3xl font-bold text-primary mt-2 flex items-baseline">
                                        <span id="currentPrice" class="mr-2"></span>
                                        <span class="text-base font-normal text-gray-500">元/个</span>
                                    </p>
                                </div>
                                <div class="mt-4 md:mt-0 flex gap-4">
                                    <button id="exportCurrentBtn" 
                                        class="px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-all-300 flex items-center"
                                    >
                                        <i class="fa fa-download mr-2"></i> 导出当前结果
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="selectionHint" class="p-6 bg-gray-50 rounded-lg border border-gray-200 text-center text-gray-500">
                            请完成六级参数选择以查看价格
                        </div>
                    </div>
                </div>

                <!-- 查询结果 -->
                <div class="bg-white rounded-xl shadow-md p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                        <i class="fa fa-bar-chart text-primary mr-2"></i>
                        查询结果详情
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="flex items-start">
                            <div class="bg-primary/10 p-2 rounded-full mr-3">
                                <i class="fa fa-cubes text-primary"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">标准类型</p>
                                <p id="resStandard" class="font-medium mt-1 text-gray-400 italic">未选择</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="bg-primary/10 p-2 rounded-full mr-3">
                                <i class="fa fa-puzzle-piece text-primary"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">管件类型</p>
                                <p id="resPipeType" class="font-medium mt-1 text-gray-400 italic">未选择</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="bg-primary/10 p-2 rounded-full mr-3">
                                <i class="fa fa-sliders text-primary"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">钢材类型</p>
                                <p id="resSteelType" class="font-medium mt-1 text-gray-400 italic">未选择</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="bg-primary/10 p-2 rounded-full mr-3">
                                <i class="fa fa-arrows-h text-primary"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">外径规格</p>
                                <p id="resOuterDiameter" class="font-medium mt-1 text-gray-400 italic">未选择</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="bg-primary/10 p-2 rounded-full mr-3">
                                <i class="fa fa-list-alt text-primary"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">规格</p>
                                <p id="resSpecification" class="font-medium mt-1 text-gray-400 italic">未选择</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="bg-primary/10 p-2 rounded-full mr-3">
                                <i class="fa fa-arrows-v text-primary"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">壁厚</p>
                                <p id="resWallThickness" class="font-medium mt-1 text-gray-400 italic">未选择</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 右侧历史记录 -->
            <div class="space-y-6">
                <!-- 查询历史 - 调整高度使其与左侧结果详情底部对齐 -->
                <div class="bg-white rounded-xl shadow-md p-6 h-full flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold text-gray-800 flex items-center">
                            <i class="fa fa-history text-primary mr-2"></i>
                            查询历史
                        </h2>
                        <div class="flex gap-2">
                            <button id="clearHistoryBtn" class="text-gray-500 hover:text-red-500 transition-all-300">
                                <i class="fa fa-trash-o"></i>
                            </button>
                            <button id="exportHistoryBtn" class="text-gray-500 hover:text-primary transition-all-300">
                                <i class="fa fa-download"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div id="emptyHistoryMsg" class="text-center py-8 text-gray-400 flex-grow flex items-center justify-center">
                        暂无查询记录
                    </div>
                    
                    <div id="historyList" class="space-y-3 overflow-y-auto pr-2 flex-grow hidden">
                        <!-- 历史记录将通过JS动态添加 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 系统帮助按钮 -->
        <div class="fixed bottom-6 right-6">
            <button id="systemHelpBtn" class="p-4 bg-primary text-white rounded-full shadow-lg hover:bg-primary/90 transition-all duration-300">
                <i class="fa fa-question text-xl"></i>
            </button>
        </div>
    </div>

    <script>
        // 数据库初始化函数 - 从localStorage加载，如无则使用默认数据
        function initDatabase() {
            // 默认管件价格数据库（根据提供的数据结构）
            const defaultDB = {
            "日标": {
                "Elbow弯头": {
                    "8A": {
                        "无缝": {
                            "1.2": { "316L EP": 100.00, "316L BA": 70.00, "304L BA": 68.00, "304 AP": 66.64 },
                            "1.65": { "316L EP": 110.00, "316L BA": 75.00, "304L BA": 73.00, "304 AP": 71.54 }
                        }
                    },
                    "10A": {
                        "无缝": {
                            "1.2": { "316L EP": 120.00, "316L BA": 82.00, "304L BA": 80.00, "304 AP": 78.40 },
                            "1.65": { "316L EP": 160.00, "316L BA": 102.00, "304L BA": 100.00, "304 AP": 98.00 }
                        }
                    },
                    "15A": {
                        "无缝": {
                            "1.65": { "316L EP": 180.00, "316L BA": 111.00, "304L BA": 105.00, "304 AP": 102.90 },
                            "2.1": { "316L EP": 270.00, "316L BA": 166.50, "304L BA": 157.50, "304 AP": 154.35 }
                        }
                    },
                    "20A": {
                        "无缝": {
                            "1.65": { "316L EP": 188.00, "316L BA": 119.00, "304L BA": 110.00, "304 AP": 107.80 },
                            "2.1": { "316L EP": 282.00, "316L BA": 178.50, "304L BA": 165.00, "304 AP": 161.70 }
                        },
                        "有缝": {
                            "1.65": { "316L EP": 182.00, "316L BA": 114.00, "304L BA": 105.00, "304 AP": 102.90 },
                            "2.1": { "316L EP": 273.00, "316L BA": 171.00, "304L BA": 157.50, "304 AP": 154.35 }
                        }
                    },
                    "25A": {
                        "无缝": {
                            "1.65": { "316L EP": 196.00, "316L BA": 126.00, "304L BA": 116.00, "304 AP": 113.68 },
                            "2.8": { "316L EP": 294.00, "316L BA": 189.00, "304L BA": 174.00, "304 AP": 170.52 }
                        },
                        "有缝": {
                            "1.65": { "316L EP": 190.00, "316L BA": 120.00, "304L BA": 110.00, "304 AP": 107.80 },
                            "2.8": { "316L EP": 285.00, "316L BA": 180.00, "304L BA": 165.00, "304 AP": 161.70 }
                        }
                    },
                    "32A": {
                        "无缝": {
                            "1.65": { "316L EP": 210.00, "316L BA": 135.00, "304L BA": 125.00, "304 AP": 122.50 },
                            "2.8": { "316L EP": 315.00, "316L BA": 202.50, "304L BA": 187.50, "304 AP": 183.75 }
                        },
                        "有缝": {
                            "1.65": { "316L EP": 205.00, "316L BA": 130.00, "304L BA": 120.00, "304 AP": 117.60 },
                            "2.8": { "316L EP": 305.00, "316L BA": 195.00, "304L BA": 180.00, "304 AP": 176.40 }
                        }
                    },
                    "40A": {
                        "无缝": {
                            "2.1": { "316L EP": 250.00, "316L BA": 160.00, "304L BA": 150.00, "304 AP": 147.00 },
                            "3.2": { "316L EP": 375.00, "316L BA": 240.00, "304L BA": 225.00, "304 AP": 220.50 }
                        },
                        "有缝": {
                            "2.1": { "316L EP": 240.00, "316L BA": 155.00, "304L BA": 145.00, "304 AP": 142.10 },
                            "3.2": { "316L EP": 360.00, "316L BA": 232.50, "304L BA": 217.50, "304 AP": 213.15 }
                        }
                    },
                    "50A": {
                        "无缝": {
                            "1.65": { "316L EP": 490, "316L BA": 199, "304L BA": 183, "304 AP": 179.34 },
                            "2.8": { "316L EP": 735,  "316L BA": 298.5, "304L BA": 274.5, "304 AP": 269.01 }
                        },
                        "有缝": {
                            "1.65": { "316L EP": 450, "316L BA": 179, "304L BA": 163, "304 AP": 159.74 },
                            "2.8": { "316L EP": 675, "316L BA": 268.5, "304L BA": 244.5, "304 AP": 239.61 }
                        }
                    },
                    "65A": {
                        "无缝": {
                            "3": { "316L EP": 975, "316L BA": 445.5, "304L BA": 391.5, "304 AP": 383.67 },
                            "2.1": { "316L EP": 650, "316L BA": 297, "304L BA": 261, "304 AP": 255.78 }
                        },
                        "有缝": {
                            "3": { "316L EP": 900, "316L BA": 370.5, "304L BA": 331.5, "304 AP": 324.87 },
                            "2.1": { "316L EP": 600, "316L BA": 247, "304L BA": 221, "304 AP": 216.58 }
                        }
                    },
                    "80A": {
                        "有缝": {
                             "3": { "316L EP": 1125, "316L BA": 472.5, "304L BA": 447, "304 AP": 438.06 },
                            "2.1": { "316L EP": 750, "316L BA": 315, "304L BA": 298, "304 AP": 292.04 }
                        }
                    },
                    "90A": {
                        "有缝": {
                            "3": { "316L EP": 1275, "316L BA": 555, "304L BA": 517.5, "304 AP": 507.15 },
                            "2.1": { "316L EP": 850, "316L BA": 370, "304L BA": 345, "304 AP": 338.1 }
                        }
                    },
					"100A": {
						"有缝": {
							"3": { "316L EP": 1425, "316L BA": 625.5, "304L BA": 561, "304 AP": 549.78 },
						"2.1": { "316L EP": 950, "316L BA": 417, "304L BA": 374, "304 AP": 366.52}
                        }
                    },
					"125A": {
						"有缝": {
							"2.8": { "316L EP": 1250, "316L BA": 600, "304L BA": 560, "304 AP": 548.8 },
							"3.4": { "316L EP": 1875, "316L BA": 900, "304L BA": 840, "304 AP": 823.2 }
                        }
                    },
                    "150A": {
						"有缝": {
							"2.8": { "316L EP": 1600, "316L BA": 800, "304L BA": 760, "304 AP": 744.8 },
							"3.4": { "316L EP": 2400, "316L BA": 1200, "304L BA": 1140, "304 AP": 1117.2 }
                        }
                    },
                    "200A": {
						"有缝": {
							"4": { "316L EP": 4000, "316L BA": 2000, "304L BA": 1960, "304 AP": 1920.8 },
							"2.8": { "316L EP": 2600, "316L BA": 1300, "304L BA": 1260, "304 AP": 1234.8 }
                        }
                    },
                    "250A": {
						"有缝": {
							"4": { "316L EP": 5000, "316L BA": 2500, "304L BA": 2460, "304 AP": 2410.8 },
							"3.4": { "316L EP": 3600, "316L BA": 1800, "304L BA": 1760, "304 AP": 1724.8 }
                        }
                    },
                    "300A": {
						"有缝": {
							"4": { "316L EP": 5100, "316L BA": 2550, "304L BA": 2510, "304 AP": 2459.8 },
							"4.5": { "316L EP": 7000, "316L BA": 3500, "304L BA": 3460, "304 AP": 3390.8 }
                        }
                    },
                    "350A": {
						"有缝": {
							"4": { "316L EP": 6200, "316L BA": 3100, "304L BA": 3060, "304 AP": 2998.8 },
							"5": { "316L EP": 8200, "316L BA": 4100, "304L BA": 4060, "304 AP": 3978.8 }
                        }
                    },
                    "400A": {
						"有缝": {
							"5": { "316L EP": 11000, "316L BA": 5500, "304L BA": 5460, "304 AP": 5350.8 },
							"4.5": { "316L EP": 7400, "316L BA": 3700, "304L BA": 3640, "304 AP": 3567.2 }
                        }
                    },
                    "450A": {
						"有缝": {
							"5": { "316L EP": 13000, "316L BA": 6500, "304L BA": 6460, "304 AP": 6330.8 },
							"4.5": { "316L EP": 8700, "316L BA": 5000, "304L BA": 4960, "304 AP": 4860.8 }
                        }
                    },
                    "500A": {
						"有缝": {
							"5": { "316L EP": 15600, "316L BA": 7800, "304L BA": 7760, "304 AP": 7604.8 },
							"4.5": { "316L EP": 10000, "316L BA": 5200, "304L BA": 5140, "304 AP": 5037.2 }
                        }
                    }
                },
                "Tee三通": {
                    "8A": {
                        "无缝": {
                            "1.2": { "316L EP": 120.00, "316L BA": 80.00, "304L BA": 78.00, "304 AP": 76.44 },
                            "1.65": { "316L EP": 140.00, "316L BA": 86.00, "304L BA": 84.00, "304 AP": 82.32 }
                        }
                    },
                    "10A": {
                        "无缝": {
                            "1.2": { "316L EP": 165.00, "316L BA": 88.00, "304L BA": 86.00, "304 AP": 84.28 },
                            "1.65": { "316L EP": 185.00, "316L BA": 95.00, "304L BA": 93.00, "304 AP": 91.14 }
                        }
                    },
                    "15A": {
						"无缝": {
							"1.65": { "316L EP": 198, "316L BA": 99, "304L BA": 82, "304 AP": 80.36 },
							"2.1": { "316L EP": 297, "316L BA": 147, "304L BA": 123, "304 AP": 120.54 }
                        }
                    },
                    "20A": {
						"无缝": {
							"1.65": { "316L EP": 210, "316L BA": 110, "304L BA": 98, "304 AP": 96.04 },
							"2.1": { "316L EP": 315, "316L BA": 165, "304L BA": 147, "304 AP": 144.06 }
                        },
						"有缝": {
							"1.65": { "316L EP": 200, "316L BA": 100, "304L BA": 88, "304 AP": 86.24 },
							"2.1": { "316L EP": 300, "316L BA": 150, "304L BA": 132, "304 AP": 129.36 }
                        }
                    },
                    "25A": {
						"无缝": {
							"1.65": { "316L EP": 236, "316L BA": 118, "304L BA": 115, "304 AP": 112.7 },
							"2.8": { "316L EP": 354, "316L BA": 177, "304L BA": 172, "304 AP": 168.56 }
						},
						"有缝": {
							"1.65": { "316L EP": 230, "316L BA": 110, "304L BA": 105, "304 AP": 102.9 },
							"2.8": { "316L EP": 345, "316L BA": 165, "304L BA": 158, "304 AP": 154.84 }
                        }
                    },
                    "32A": {
						"无缝": {
							"1.65": { "316L EP": 264, "316L BA": 126, "304L BA": 121, "304 AP": 118.58 },
							"2.8": { "316L EP": 396, "316L BA": 189, "304L BA": 182, "304 AP": 178.36 }
						},
						"有缝": {
							"1.65": { "316L EP": 244, "316L BA": 116, "304L BA": 111, "304 AP": 108.78 },
							"2.8": { "316L EP": 366, "316L BA": 174, "304L BA": 166.5, "304 AP": 163.17 }
                        }
                    },
                    "40A": {
						"无缝": {
							"1.65": { "316L EP": 430, "316L BA": 220, "304L BA": 215, "304 AP": 210.7 },
							"2.8": { "316L EP": 645, "316L BA": 330, "304L BA": 322.5, "304 AP": 316.05 }
						},
						"有缝": {
							"1.65": { "316L EP": 400, "316L BA": 200, "304L BA": 195, "304 AP": 191.1 },
							"2.8": { "316L EP": 600, "316L BA": 300, "304L BA": 285, "304 AP": 279.3 }
                        }
                    },
                    "50A": {
						"无缝": {
							"1.65": { "316L EP": 600, "316L BA": 250, "304L BA": 235, "304 AP": 230.3 },
							"2.8": { "316L EP": 900, "316L BA": 375, "304L BA": 360, "304 AP": 352.8 }
						},
						"有缝": {
							"1.65": { "316L EP": 550, "316L BA": 230, "304L BA": 215, "304 AP": 210.7 },
							"2.8": { "316L EP": 825, "316L BA": 345, "304L BA": 330, "304 AP": 323.4 }
                        }
                    },
                    "65A": {
						"无缝": {
							"3": { "316L EP": 1050, "316L BA": 495, "304L BA": 480, "304 AP": 470.4 },
							"2.1": { "316L EP": 700, "316L BA": 330, "304L BA": 310, "304 AP": 303.8 }
						},
						"有缝": {
							"3": { "316L EP": 975, "316L BA": 450, "304L BA": 435, "304 AP": 426.3 },
							"2.1": { "316L EP": 650, "316L BA": 300, "304L BA": 280, "304 AP": 274.4 }
                        }
                    },
                    "80A": {
						"有缝": {
							"3": { "316L EP": 1125, "316L BA": 525, "304L BA": 495, "304 AP": 485.1 },
							"2.1": { "316L EP": 750, "316L BA": 350, "304L BA": 330, "304 AP": 323.4 }
                        }
                    },
                    "90A": {
						"有缝": {
							"3": { "316L EP": 1275, "316L BA": 630, "304L BA": 570, "304 AP": 558.6 },
							"2.1": { "316L EP": 850, "316L BA": 420, "304L BA": 380, "304 AP": 372.4 }
                        }
                    },
                    "100A": {
						"有缝": {
							"3": { "316L EP": 1575, "316L BA": 690, "304L BA": 600, "304 AP": 588 },
							"2.1": { "316L EP": 1050, "316L BA": 460, "304L BA": 400, "304 AP": 392 }
                        }
                    },
                    "125A": {
						"有缝": {
							"2.8": { "316L EP": 1305, "316L BA": 650, "304L BA": 600, "304 AP": 588 },
							"3.4": { "316L EP": 1800, "316L BA": 900, "304L BA": 860, "304 AP": 842.8 }
                        }
                    },
                    "150A": {
						"有缝": {
							"2.8": { "316L EP": 1520, "316L BA": 760, "304L BA": 720, "304 AP": 705.6 },
							"3.4": { "316L EP": 1957.5, "316L BA": 975, "304L BA": 900, "304 AP": 882 }
                        }
                    },
                    "200A": {
						"有缝": {
							"4": { "316L EP": 4400, "316L BA": 2200, "304L BA": 2160, "304 AP": 2116.8 },
							"2.8": { "316L EP": 2800, "316L BA": 1400, "304L BA": 1360, "304 AP": 1332.8 }
                        }
                    },
                    "250A": {
						"有缝": {
							"4": { "316L EP": 5600, "316L BA": 2800, "304L BA": 2760, "304 AP": 2704.8 },
							"3.4": { "316L EP": 4400, "316L BA": 2200, "304L BA": 2160, "304 AP": 2116.8 }
                        }
                    },
                    "300A": {
						"有缝": {
							"4": { "316L EP": 5600, "316L BA": 2800, "304L BA": 2760, "304 AP": 2704.8 },
							"4.5": { "316L EP": 7000, "316L BA": 3500, "304L BA": 3460, "304 AP": 3390.8 }
                        }
                    },
                    "350A": {
						"有缝": {
							"4": { "316L EP": 7600, "316L BA": 3800, "304L BA": 3760, "304 AP": 3684.8 },
							"5": { "316L EP": 9000, "316L BA": 4500, "304L BA": 4460, "304 AP": 4370.8 }
                        }
                    },
                    "400A": {
						"有缝": {
							"5": { "316L EP": 11000, "316L BA": 5500, "304L BA": 5460, "304 AP": 5350.8 },
							"4.5": { "316L EP": 9600, "316L BA": 4800, "304L BA": 4760, "304 AP": 4664.8 }
                        }
                    },
                    "450A": {
						"有缝": {
							"5": { "316L EP": 14000, "316L BA": 7000, "304L BA": 6960, "304 AP": 6820.8 },
							"4.5": { "316L EP": 12800, "316L BA": 6400, "304L BA": 6360, "304 AP": 6232.8 }
                        }
                    },
                    "500A": {
						"有缝": {
							"5": { "316L EP": 15000, "316L BA": 7500, "304L BA": 7460, "304 AP": 7310.8 },
							"5.5": { "316L EP": 16100, "316L BA": 8050, "304L BA": 8010, "304 AP": 7849.8 }
                        }
                    }
                },
                "Reducer大小头": {
                    "8A": {
                        "无缝": {
                            "1.2": { "316L EP": "-", "316L BA": "-", "304L BA": "-", "304 AP": "-" },
                            "1.65": { "316L EP": "-", "316L BA": "-", "304L BA": "-", "304 AP": "-" }
                        }
                    },
                    "10A": {
                        "无缝": {
                            "1.2": { "316L EP": 200.00, "316L BA": 115.00, "304L BA": 110.00, "304 AP": 107.80 },
                            "1.65": { "316L EP": 220.00, "316L BA": 120.00, "304L BA": 115.00, "304 AP": 112.70 }
                        }
                    },
                    "15A": {
						"无缝": {
							"1.65": { "316L EP": 285, "316L BA": 130, "304L BA": 121, "304 AP": 118.58 },
							"2.1": { "316L EP": 427.5, "316L BA": 195, "304L BA": 181.5, "304 AP": 177.87 }
                        }
                    },
                    "20A": {
						"无缝": {
							"1.65": { "316L EP": 300, "316L BA": 140, "304L BA": 130, "304 AP": 127.4 },
							"2.1": { "316L EP": 450, "316L BA": 210, "304L BA": 200, "304 AP": 196 }
						},
						"有缝": {
							"1.65": { "316L EP": 280, "316L BA": 116, "304L BA": 109, "304 AP": 106.82 },
							"2.1": { "316L EP": 430, "316L BA": 174, "304L BA": 165, "304 AP": 161.7 }
                        }
                    },
                    "25A": {
						"无缝": {
							"1.65": { "316L EP": 310, "316L BA": 150, "304L BA": 140, "304 AP": 137.2 },
							"2.8": { "316L EP": 470, "316L BA": 225, "304L BA": 205, "304 AP": 200.9 }
						},
						"有缝": {
							"1.65": { "316L EP": 294, "316L BA": 120, "304L BA": 110, "304 AP": 107.8 },
							"2.8": { "316L EP": 441, "316L BA": 190, "304L BA": 180, "304 AP": 176.4 }
                        }
                    },
                    "32A": {
						"无缝": {
							"1.65": { "316L EP": 320, "316L BA": 150, "304L BA": 140, "304 AP": 137.2 },
							"2.8": { "316L EP": 480, "316L BA": 225, "304L BA": 210, "304 AP": 205.8 }
						},
						"有缝": {
							"1.65": { "316L EP": 300, "316L BA": 130, "304L BA": 120, "304 AP": 117.6 },
							"2.8": { "316L EP": 450, "316L BA": 195, "304L BA": 185, "304 AP": 181.3 }
                        }
                    },
                    "40A": {
						"无缝": {
							"1.65": { "316L EP": 360, "316L BA": 165, "304L BA": 155, "304 AP": 151.9 },
							"2.8": { "316L EP": 540, "316L BA": 248, "304L BA": 238, "304 AP": 233.24 }
						},
						"有缝": {
							"1.65": { "316L EP": 340, "316L BA": 150, "304L BA": 140, "304 AP": 137.2 },
							"2.8": { "316L EP": 510, "316L BA": 225, "304L BA": 215, "304 AP": 210.7 }
                        }
                    },
                    "50A": {
						"无缝": {
							"1.65": { "316L EP": 405, "316L BA": 212, "304L BA": 190, "304 AP": 186.2 },
                    "2.8": { "316L EP": 607.5, "316L BA": 318, "304L BA": 305, "304 AP": 298.9 }
						},
						"有缝": {
							"1.65": { "316L EP": 375, "316L BA": 190, "304L BA": 180, "304 AP": 176.4 },
							"2.8": { "316L EP": 563, "316L BA": 285, "304L BA": 270, "304 AP": 264.6 }
                        }
                    },
                    "65A": {
						"无缝": {
							"3": { "316L EP": 840, "316L BA": 420, "304L BA": 405, "304 AP": 396.9 },
							"2.1": { "316L EP": 560, "316L BA": 280, "304L BA": 270, "304 AP": 264.6 }
						},
						"有缝": {
							"3": { "316L EP": 780, "316L BA": 390, "304L BA": 375, "304 AP": 367.5 },
							"2.1": { "316L EP": 520, "316L BA": 260, "304L BA": 250, "304 AP": 245 }
                        }
                    },
					"80A": {
						"有缝": {
							"3": { "316L EP": 1200, "316L BA": 600, "304L BA": 560, "304 AP": 548.8 },
							"2.1": { "316L EP": 680, "316L BA": 340, "304L BA": 300, "304 AP": 294 }
                        }
                    },
					"90A": {
						"有缝": {
							"3": { "316L EP": 1400, "316L BA": 700, "304L BA": 660, "304 AP": 646.8 },
							"2.1": { "316L EP": 800, "316L BA": 400, "304L BA": 360, "304 AP": 352.8 }
                        }
                    },
                    "100A": {
						"有缝": {
							"3": { "316L EP": 1600, "316L BA": 800, "304L BA": 760, "304 AP": 744.8 },
							"2.1": { "316L EP": 1000, "316L BA": 500, "304L BA": 460, "304 AP": 450.8 }
                        }
                    },
                    "125A": {
						"有缝": {
							"2.8": { "316L EP": 1200, "316L BA": 600, "304L BA": 560, "304 AP": 548.8 },
							"3.4": { "316L EP": 2000, "316L BA": 1000, "304L BA": 960, "304 AP": 940.8 }
                        }
                    },
                    "150A": {
						"有缝": {
							"2.8": { "316L EP": 1800, "316L BA": 900, "304L BA": 860, "304 AP": 842.8 },
							"3.4": { "316L EP": 2200, "316L BA": 1100, "304L BA": 1060, "304 AP": 1038.8 }
                        }
                    },
                    "200A": {
						"有缝": {
							"2.8": { "316L EP": 2200, "316L BA": 1100, "304L BA": 1060, "304 AP": 1038.8 },
							"3.4": { "316L EP": 2600, "316L BA": 1300, "304L BA": 1260, "304 AP": 1234.8 }
                        }
                    },
                    "250A": {
						"有缝": {
							"4": { "316L EP": 3800, "316L BA": 1900, "304L BA": 1860, "304 AP": 1822.8 },
							"3.4": { "316L EP": 3400, "316L BA": 1700, "304L BA": 1660, "304 AP": 1626.8 }
                        }
                    },
                    "300A": {
						"有缝": {
							"4": { "316L EP": 4000, "316L BA": 2000, "304L BA": 1960, "304 AP": 1920.8 },
							"4.5": { "316L EP": 4400, "316L BA": 2200, "304L BA": 2160, "304 AP": 2116.8 }
                        }
                    },
                    "350A": {
						"有缝": {
							"4": { "316L EP": 4600, "316L BA": 2300, "304L BA": 2260, "304 AP": 2214.8 },
							"5": { "316L EP": 5000, "316L BA": 2500, "304L BA": 2460, "304 AP": 2410.8 }
                        }
                    },
                    "400A": {
						"有缝": {
							"5": { "316L EP": 8200, "316L BA": 4100, "304L BA": 4060, "304 AP": 3978.8 },
							"4.5": { "316L EP": 7800, "316L BA": 3900, "304L BA": 3860, "304 AP": 3782.8 }
                        }
                    },
                    "450A": {
						"有缝": {
							"5": { "316L EP": 8600, "316L BA": 4300, "304L BA": 4260, "304 AP": 4174.8 },
							"4.5": { "316L EP": 8200, "316L BA": 4100, "304L BA": 4060, "304 AP": 3978.8 }
                        }
                    },
                    "500A": {
						"有缝": {
							"5": { "316L EP": 9000, "316L BA": 4500, "304L BA": 4460, "304 AP": 4370.8 },
							"5.5": { "316L EP": 9400, "316L BA": 4700, "304L BA": 4660, "304 AP": 4566.8 }
                        }
                    }
                }
            },
            "英制": {
                "Elbow弯头": {
                    "1/8\"": {
                        "无缝": {
                            "0.71": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "1/4\"": {
                        "无缝": {
                            "0.89": { "316L EP": 85.00, "316L BA": 52.00, "304L BA": 51.00, "304 AP": 50.00 },
                            "1": { "316L EP": 86.00, "316L BA": 53.00, "304L BA": 52.00, "304 AP": 51.00 }
                        }
                    },
                    "3/8\"": {
                        "无缝": {
                            "0.89": { "316L EP": 87.00, "316L BA": 55.00, "304L BA": 54.00, "304 AP": 53.00 },
                            "1": { "316L EP": 88.00, "316L BA": 56.00, "304L BA": 55.00, "304 AP": 54.00 }
                        }
                    },
                    "1/2\"": {
                        "无缝": {
                            "1": { "316L EP": 100.00, "316L BA": 62.00, "304L BA": 61.00, "304 AP": 60.00 },
                            "1.24": { "316L EP": 105.00, "316L BA": 68.00, "304L BA": 67.00, "304 AP": 66.00 },
                            "1.65": { "316L EP": 110.00, "316L BA": 75.00, "304L BA": 74.00, "304 AP": 73.00 }
                        }
                    },
                    "5/8\"": {
                        "无缝": {
                            "1": { "316L EP": 105.00, "316L BA": 65.00, "304L BA": 63.00, "304 AP": 62.00 },
                            "1.24": { "316L EP": 115.00, "316L BA": 70.00, "304L BA": 68.00, "304 AP": 67.00 }
                        }
                    },
                    "3/4\"": {
                        "无缝": {
                            "1.24": { "316L EP": 120.00, "316L BA": 80.00, "304L BA": 78.00, "304 AP": 76.00 },
                            "1.65": { "316L EP": 160.00, "316L BA": 84.00, "304L BA": 82.00, "304 AP": 80.00 }
                        },
                        "有缝": {
                            "1.24": { "316L EP": 100.00, "316L BA": 70.00, "304L BA": 68.00, "304 AP": 67.00 },
                            "1.65": { "316L EP": 140.00, "316L BA": 74.00, "304L BA": 72.00, "304 AP": 71.00 }
                        }
                    },
                    "1\"": {
                        "无缝": {
                            "1.24": { "316L EP": 170.00, "316L BA": 90.00, "304L BA": 88.00, "304 AP": 86.00 },
                            "1.65": { "316L EP": 176.00, "316L BA": 94.00, "304L BA": 92.00, "304 AP": 90.00 }
                        },
                        "有缝": {
                            "1.24": { "316L EP": 165.00, "316L BA": 80.00, "304L BA": 78.00, "304 AP": 76.00 },
                            "1.65": { "316L EP": 166.00, "316L BA": 84.00, "304L BA": 82.00, "304 AP": 80.00 }
                        }
                    },
                    "1.25\"": {
                        "无缝": {
                            "1.65": { "316L EP": 200.00, "316L BA": 105.00, "304L BA": 102.00, "304 AP": 100.00 }
                        },
                        "有缝": {
                            "1.65": { "316L EP": 180.00, "316L BA": 95.00, "304L BA": 92.00, "304 AP": 90.00 }
                        }
                    },
                    "1.5\"": {
                        "无缝": {
                            "1.65": { "316L EP": 228.00, "316L BA": 115.00, "304L BA": 113.00, "304 AP": 111.00 }
                        },
                        "有缝": {
                            "1.65": { "316L EP": 208.00, "316L BA": 105.00, "304L BA": 103.00, "304 AP": 101.00 }
                        }
                    },
                    "2\"": {
                        "无缝": {
                            "1.65": { "316L EP": 285.00, "316L BA": 145.00, "304L BA": 135.00, "304 AP": 132.00 }
                        },
                        "有缝": {
                            "1.65": { "316L EP": 265.00, "316L BA": 135.00, "304L BA": 125.00, "304 AP": 123.00 }
                        }
                    },
                    "2.5\"": {
                        "无缝": {
                            "1.65": { "316L EP": 500.00, "316L BA": 220.00, "304L BA": 210.00, "304 AP": 206.00 }
                        },
                        "有缝": {
                            "1.65": { "316L EP": 460.00, "316L BA": 200.00, "304L BA": 190.00, "304 AP": 186.00 }
                        }
                    },
                    "3\"": {
                        "无缝": {
                            "1.65": { "316L EP": 630.00, "316L BA": 290.00, "304L BA": 280.00, "304 AP": 274.00 }
                        },
                        "有缝": {
                            "1.65": { "316L EP": 580.00, "316L BA": 240.00, "304L BA": 230.00, "304 AP": 225.00 }
                        }
                    },
                    "4\"": {
                        "无缝": {
                            "2.11": { "316L EP": 900.00, "316L BA": 400.00, "304L BA": 390.00, "304 AP": 382.00 }
                        },
                        "有缝": {
                            "2.11": { "316L EP": 850.00, "316L BA": 360.00, "304L BA": 350.00, "304 AP": 343.00 }
                        }
                    },
                    "5\"": {
                        "无缝": {
                            "2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
                        },
                        "有缝": {
                            "2.77": { "316L EP": 1150.00, "316L BA": 550.00, "304L BA": 540.00, "304 AP": 520.00 }
                        }
                    },
                    "6\"": {
                        "无缝": {
                            "2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
                        },
                        "有缝": {
                            "2.77": { "316L EP": 1500.00, "316L BA": 750.00, "304L BA": 730.00, "304 AP": 710.00 }
                        }
                    },
                    "8\"": {
                        "无缝": {
                            "2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
                        },
                        "有缝": {
                            "2.77": { "316L EP": 2500.00, "316L BA": 1200.00, "304L BA": 1180.00, "304 AP": 1150.00 }
                        }
                    },
                    "10\"": {
                        "无缝": {
                            "3.65": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
                        },
                        "有缝": {
                            "3.65": { "316L EP": 3500.00, "316L BA": 1700.00, "304L BA": 1650.00, "304 AP": 1600.00 }
                        }
                    },
                    "12\"": {
                        "无缝": {
                            "3.8": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
                        },
                        "有缝": {
                            "3.8": { "316L EP": 5000.00, "316L BA": 2450.00, "304L BA": 2400.00, "304 AP": 2350.00 }
                        }
                    }
                },
                "Tee 三通 （含R TEE）": {
                    "1/8\"": {
                        "无缝": {
                            "0.71": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "1/4\"": {
                        "无缝": {
                            "0.89": { "316L EP": 90, "316L BA": 65, "304L BA": 64, "304 AP": 63 },
                            "1": { "316L EP": 91, "316L BA": 66, "304L BA": 65, "304 AP": 64 }
                        }
                    },
                    "3/8\"": {
                        "无缝": {
                            "0.89": { "316L EP": 100, "316L BA": 75, "304L BA": 74, "304 AP": 73 },
                            "1": { "316L EP": 101, "316L BA": 76, "304L BA": 75, "304 AP": 74 }
                        }
                    },
                    "1/2\"": {
                        "无缝": {
                            "1": { "316L EP": 105, "316L BA": 80, "304L BA": 79, "304 AP": 77 },
                            "1.24": { "316L EP": 110, "316L BA": 85, "304L BA": 80, "304 AP": 78 },
                            "1.65": { "316L EP": 115, "316L BA": 90, "304L BA": 85, "304 AP": 83 }
                        }
                    },
                    "5/8\"": {
						"无缝": {
							"1": { "316L EP": 130, "316L BA": 85, "304L BA": 83, "304 AP": 81 },
							"1.24": { "316L EP": 140, "316L BA": 95, "304L BA": 93, "304 AP": 91 }
                        }
                    },
                    "3/4\"": {
						"无缝": {
							"1.24": { "316L EP": 160, "316L BA": 100, "304L BA": 95, "304 AP": 93 },
							"1.65": { "316L EP": 180, "316L BA": 100, "304L BA": 98, "304 AP": 96 }
						},
						"有缝": {
							"1.24": { "316L EP": 150, "316L BA": 90, "304L BA": 85, "304 AP": 83 },
							"1.65": { "316L EP": 160, "316L BA": 105, "304L BA": 100, "304 AP": 98 }
                        }
                    },
                    "1\"": {
						"无缝": {
							"1.24": { "316L EP": 184, "316L BA": 90, "304L BA": 88, "304 AP": 86 },
							"1.65": { "316L EP": 204, "316L BA": 110, "304L BA": 105, "304 AP": 103 }
						},
						"有缝": {
							"1.24": { "316L EP": 190, "316L BA": 80, "304L BA": 78, "304 AP": 76 },
							"1.65": { "316L EP": 195, "316L BA": 90, "304L BA": 88, "304 AP": 86 }
                        }
                    },
                    "1.25\"": {
						"无缝": {
							"1.65": { "316L EP": 220, "316L BA": 120, "304L BA": 118, "304 AP": 116 }
						},
						"有缝": {
							"1.65": { "316L EP": 200, "316L BA": 100, "304L BA": 98, "304 AP": 96 }
                        }
                    },
                    "1.5\"": {
						"无缝": {
							"1.65": { "316L EP": 260, "316L BA": 150, "304L BA": 148, "304 AP": 145 }
						},
						"有缝": {
							"1.65": { "316L EP": 247, "316L BA": 135, "304L BA": 132, "304 AP": 129 }
                        }
                    },
                    "2\"": {
						"无缝": {
							"1.65": { "316L EP": 450, "316L BA": 200, "304L BA": 195, "304 AP": 191 }
						},
						"有缝": {
							"1.65": { "316L EP": 430, "316L BA": 180, "304L BA": 175, "304 AP": 172 }
                        }
                    },
                    "2.5\"": {
						"无缝": {
							"1.65": { "316L EP": 610, "316L BA": 260, "304L BA": 255, "304 AP": 250 }
						},
						"有缝": {
							"1.65": { "316L EP": 560, "316L BA": 240, "304L BA": 235, "304 AP": 230 }
                        }
                    },
                    "3\"": {
						"无缝": {
							"1.65": { "316L EP": 680, "316L BA": 310, "304L BA": 305, "304 AP": 299 }
						},
						"有缝": {
							"1.65": { "316L EP": 630, "316L BA": 280, "304L BA": 275, "304 AP": 270 }
                        }
                    },
                    "4\"": {
						"无缝": {
							"2.11": { "316L EP": 900, "316L BA": 450, "304L BA": 410, "304 AP": 402 }
						},
						"有缝": {
							"2.11": { "316L EP": 850, "316L BA": 420, "304L BA": 380, "304 AP": 372 }
                        }
                    },
                    "5\"": {
						"无缝": {
							"2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
						},
						"有缝": {
							"2.77": { "316L EP": 1250, "316L BA": 600, "304L BA": 590, "304 AP": 570 }
                        }
                    },
                    "6\"": {
						"无缝": {
							"2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
						},
						"有缝": {
							"2.77": { "316L EP": 1450, "316L BA": 710, "304L BA": 700, "304 AP": 680 }
                        }
                    },
                    "8\"": {
						"无缝": {
							"2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
						},
						"有缝": {
							"2.77": { "316L EP": 2800, "316L BA": 1400, "304L BA": 1380, "304 AP": 1350 }
                        }
                    },
                    "10\"": {
						"无缝": {
							"3.65": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
						},
						"有缝": {
							"3.65": { "316L EP": 4400, "316L BA": 2200, "304L BA": 2180, "304 AP": 2150 }
                        }
                    },
                    "12\"": {
						"无缝": {
							"3.8": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
						},
						"有缝": {
							"3.8": { "316L EP": 5600, "316L BA": 2800, "304L BA": 2760, "304 AP": 2720 }
                        }
                    }
                },
                "Reducer 大小头": {
                    "1/8\"*": {
						"无缝": {
							"0.71": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
                        }
                    },
                    "1/4\"": {
						"无缝": {
							"1": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null },
							"0.89": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
                        }
                    },
                    "3/8\"": {
						"无缝": {
							"1": { "316L EP": 71, "316L BA": 51, "304L BA": 50, "304 AP": 49 },
							"0.89": { "316L EP": 70, "316L BA": 50, "304L BA": 49, "304 AP": 48 }
                        }
                    },
                    "1/2\"": {
						"无缝": {
							"1": { "316L EP": 75, "316L BA": 55, "304L BA": 54, "304 AP": 53 },
							"1.24": { "316L EP": 76, "316L BA": 56, "304L BA": 55, "304 AP": 54 },
							"1.65": { "316L EP": 80, "316L BA": 65, "304L BA": 63, "304 AP": 62 }
                        }
                    },
                    "5/8\"": {
						"无缝": {
							"1": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null },
							"1.24": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
                        }
                    },
                    "3/4\"": {
						"无缝": {
							"1.24": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null },
							"1.65": { "316L EP": 265, "316L BA": 120, "304L BA": 115, "304 AP": 113 }
						},
						"有缝": {
							"1.24": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null },
							"1.65": { "316L EP": 250, "316L BA": 115, "304L BA": 110, "304 AP": 108 }
                        }
                    },
                    "1\"": {
						"无缝": {
							"1.24": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null },
							"1.65": { "316L EP": 280, "316L BA": 130, "304L BA": 121, "304 AP": 119 }
						},
						"有缝": {
							"1.24": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null },
							"1.65": { "316L EP": 260, "316L BA": 125, "304L BA": 115, "304 AP": 113 }
                        }
                    },
                    "1.25\"": {
						"无缝": {
							"1.65": { "316L EP": 295, "316L BA": 140, "304L BA": 130, "304 AP": 127 }
                    },
						"有缝": {
							"1.65": { "316L EP": 275, "316L BA": 130, "304L BA": 122, "304 AP": 120 }
                        }
                    },
                    "1.5\"": {
						"无缝": {
							"1.65": { "316L EP": 310, "316L BA": 150, "304L BA": 140, "304 AP": 137 }
						},
						"有缝": {
							"1.65": { "316L EP": 290, "316L BA": 140, "304L BA": 130, "304 AP": 127 }
                        }
                    },
                    "2\"": {
						"无缝": {
							"1.65": { "316L EP": 360, "316L BA": 160, "304L BA": 155, "304 AP": 152 }
                    },
						"有缝": {
							"1.65": { "316L EP": 345, "316L BA": 145, "304L BA": 140, "304 AP": 137 }
                        }
                    },
                    "2.5\"": {
						"无缝": {
							"1.65": { "316L EP": 410, "316L BA": 215, "304L BA": 195, "304 AP": 191 }
						},
						"有缝": {
							"1.65": { "316L EP": 390, "316L BA": 205, "304L BA": 185, "304 AP": 181 }
                        }
                    },
                    "3\"": {
						"无缝": {
							"1.65": { "316L EP": 550, "316L BA": 270, "304L BA": 260, "304 AP": 255 }
						},
						"有缝": {
							"1.65": { "316L EP": 530, "316L BA": 250, "304L BA": 240, "304 AP": 235 }
                        }
                    },
                    "4\"": {
						"无缝": {
							"2.11": { "316L EP": 820, "316L BA": 420, "304L BA": 380, "304 AP": 372 }
						},
						"有缝": {
							"2.11": { "316L EP": 800, "316L BA": 400, "304L BA": 360, "304 AP": 353 }
                        }
                    },
                    "5\"": {
						"无缝": {
							"2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
						},
						"有缝": {
							"2.77": { "316L EP": 1200, "316L BA": 600, "304L BA": 560, "304 AP": 540 }
                        }
                    },
                    "6\"": {
						"无缝": {
							"2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
						},
						"有缝": {
							"2.77": { "316L EP": 1800, "316L BA": 900, "304L BA": 860, "304 AP": 840 }
                        }
                    },
                    "8\"": {
						"无缝": {
							"2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
						},
						"有缝": {
							"2.77": { "316L EP": 2200, "316L BA": 1100, "304L BA": 1060, "304 AP": 1030 }
                        }
                    },
                    "10\"": {
						"无缝": {
							"2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
						},
						"有缝": {
							"2.77": { "316L EP": 3400, "316L BA": 1700, "304L BA": 1660, "304 AP": 1620 }
                        }
                    },
                    "12\"": {
						"无缝": {
							"2.77": { "316L EP": null, "316L BA": null, "304L BA": null, "304 AP": null }
						},
						"有缝": {
							"2.77": { "316L EP": 4000, "316L BA": 2000, "304L BA": 1960, "304 AP": 1920 }
                        }
                    }
                },
                "CoAxial Elbow双套弯头": {
                    "内径1/4\"": {
                        "无缝": {
                            "外径1/2\"": { "316L EP": 450, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径3/8\"": {
                        "无缝": {
                            "外径5/8\"": { "316L EP": 460, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径3/4\"": {
						"无缝": {
                            "外径1\"": { "316L EP": 500, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1\"": {
						"无缝": {
                            "外径1.25\"": { "316L EP": 600, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1.5\"": {
						"无缝": {
                            "外径2\"": { "316L EP": 890, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径2\"": {
						"无缝": {
                            "外径2.5\"": { "316L EP": 1200, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    }
                },
                "CoAxial Tee双套三通": {
                    "内径1/4\"": {
                        "无缝": {
                            "外径1/2\"": { "316L EP": 513, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径3/8\"": {
                        "无缝": {
                            "外径5/8\"": { "316L EP": 538, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1/2\"": {
						"无缝": {
                            "外径3/4\"": { "316L EP": 575, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径3/4\"": {
						"无缝": {
                            "外径1\"": { "316L EP": 663, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1\"": {
						"无缝": {
                            "外径1.25\"": { "316L EP": 763, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1.5\"": {
						"无缝": {
                            "外径2\"": { "316L EP": 1025, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径2\"": {
						"无缝": {
                            "外径2.5\"": { "316L EP": 1500, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    }
                },
                "CoAxial Reducer双套大小头": {
                    "内径1/4\"": {
                        "无缝": {
                            "外径1/2\"": { "316L EP": 475, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径3/8\"": {
                        "无缝": {
                            "外径5/8\"": { "316L EP": 500, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1/2\"": {
						"无缝": {
                            "外径3/4\"": { "316L EP": 525, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径3/4\"": {
						"无缝": {
                            "外径1\"": { "316L EP": 538, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1\"": {
						"无缝": {
                            "外径1.25\"": { "316L EP": 625, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1.5\"": {
						"无缝": {
                            "外径2\"": { "316L EP": 938, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径2\"": {
						"无缝": {
                            "外径2.5\"": { "316L EP": 1375, "316L BA": null, "304L BA": null, "304 AP": null },
                        }
                    }
                },
                "Spring弹簧": {
                    "内径1/4\"": {
                        "无缝": {
                            "外径1/2\"": { "316L EP": null, "316L BA": null, "304L BA": 6, "304 AP": null },
                        }
                    },
                    "内径3/8\"": {
                        "无缝": {
                            "外径5/8\"": { "316L EP": null, "316L BA": null, "304L BA": 7, "304 AP": null },
                        }
                    },
                    "内径1/2\"": {
						"无缝": {
                            "外径3/4\"": { "316L EP": null, "316L BA": null, "304L BA": 7, "304 AP": null },
                        }
                    },
                    "内径3/4\"": {
						"无缝": {
                            "外径1\"": { "316L EP": null, "316L BA": null, "304L BA": 11, "304 AP": null },
                        }
                    },
                    "内径1\"": {
						"无缝": {
                            "外径1.25\"": { "316L EP": null, "316L BA": null, "304L BA": 11, "304 AP": null },
                        }
                    },
                    "内径1.5\"": {
						"无缝": {
                            "外径2\"": { "316L EP": null, "316L BA": null, "304L BA": 27, "304 AP": null },
                        }
                    },
                    "内径2\"": {
						"无缝": {
                            "外径2.5\"": { "316L EP": null, "316L BA": null, "304L BA": 35, "304 AP": null },
                        }
                    }
                },
                "Sleeve滑套": {
                    "1/4\"": {
                        "无缝": {
                            "1.24": { "316L EP": null, "316L BA": null, "304L BA": 28, "304 AP": null },
                        }
                    },
                    "5/8\"": {
                        "无缝": {
                            "1.24": { "316L EP": null, "316L BA": null, "304L BA": 35, "304 AP": null },
                        }
                    },
                    "3/4\"": {
						"无缝": {
                            "1.65": { "316L EP": null, "316L BA": null, "304L BA": 41, "304 AP": null },
                        }
                    },
                    "1\"": {
						"无缝": {
                            "1.65": { "316L EP": null, "316L BA": null, "304L BA": 48, "304 AP": null },
                        }
                    },
                    "1.5\"": {
						"无缝": {
                            "1.65": { "316L EP": null, "316L BA": null, "304L BA": 85, "304 AP": null },
                        }
                    },
                    "2\"": {
						"无缝": {
                            "1.65": { "316L EP": null, "316L BA": null, "304L BA": 105, "304 AP": null },
                        }
                    },
                    "2.5\"": {
						"无缝": {
                            "1.65": { "316L EP": null, "316L BA": null, "304L BA": 125, "304 AP": null },
                        }
                    }
                },
                "End Ring收尾环": {
                    "内径1/4\"": {
                        "无缝": {
                            "外径1/2\"": { "316L EP": null, "316L BA": 37, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径3/8\"": {
                        "无缝": {
                            "外径5/8\"": { "316L EP": null, "316L BA": 44, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1/2\"": {
						"无缝": {
                            "外径3/4\"": { "316L EP": null, "316L BA": 50, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径3/4\"": {
						"无缝": {
                            "外径1\"": { "316L EP": null, "316L BA": 67, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1\"": {
						"无缝": {
                            "外径1.25\"": { "316L EP": null, "316L BA": 111, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径1.5\"": {
						"无缝": {
                            "外径2\"": { "316L EP": null, "316L BA": 137, "304L BA": null, "304 AP": null },
                        }
                    },
                    "内径2\"": {
						"无缝": {
                            "外径2.5\"": { "316L EP": null, "316L BA": 160, "304L BA": null, "304 AP": null },
                            }
                        }
                    }
                },
                "DN": {
                    "球阀": {
                        "1/4\"": {
                            "1000Psi": {
                                "卡套": { "316L EP": null, "316L BA": 69.33, "304L BA": null, "304 AP": null }
                            },
                            "2000Psi": {
                                "卡套": { "316L EP": 105.67, "316L BA": 98.33, "304L BA": 89.67, "304 AP": 86.33 }
                            }
                        },
                        "1/2\"": {
                            "1000Psi": {
                                "卡套": { "316L EP": 120.67, "316L BA": 105.33, "304L BA": 95.67, "304 AP": 92.33 }
                            }
                        }
                    },
                    "法兰": {
                        "DN15": {
                            "PN16": {
                                "RF": { "316L EP": 210.00, "316L BA": 180.00, "304L BA": 160.00, "304 AP": 155.00 }
                            }
                        }
                    }
                }
            };

            // 尝试从localStorage获取保存的数据库
            const savedDB = localStorage.getItem('pipePriceDatabase');
            
            if (savedDB) {
                try {
                    // 解析并返回保存的数据库
                    return JSON.parse(savedDB);
                } catch (error) {
                    console.error('解析保存的数据库失败，使用默认数据库:', error);
                    return defaultDB;
                }
            } else {
                // 没有保存的数据库，使用默认数据库并保存到localStorage
                localStorage.setItem('pipePriceDatabase', JSON.stringify(defaultDB));
                return defaultDB;
            }
        }

        // 全局管件价格数据库（从localStorage加载或使用默认数据）
        let pipePriceDB = initDatabase();

        // 工具函数：填充选择框选项
        function fillSelectWithKeys(selectElement, dataObject, defaultText) {
            // 清空现有选项
            selectElement.innerHTML = '';
            
            // 添加默认选项
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = defaultText || '请选择';
            selectElement.appendChild(defaultOption);
            
            // 如果数据对象不存在，直接返回
            if (!dataObject) return;
            
            // 添加数据选项
            Object.keys(dataObject).forEach(key => {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = key;
                selectElement.appendChild(option);
            });
        }

        // 工具函数：启用选择框
        function enableSelect(selectElement) {
            selectElement.disabled = false;
            selectElement.classList.remove('bg-gray-50', 'cursor-not-allowed');
            selectElement.classList.add('bg-white', 'cursor-pointer');
        }

        // 工具函数：禁用选择框并重置
        function resetSelect(selectElement, defaultText) {
            selectElement.disabled = true;
            selectElement.innerHTML = `<option value="">${defaultText || '请先选择上一项'}</option>`;
            selectElement.classList.remove('bg-white', 'cursor-pointer');
            selectElement.classList.add('bg-gray-50', 'cursor-not-allowed');
        }

        // 显示价格
        function showPrice(price) {
            const priceDisplay = document.getElementById('priceDisplay');
            const currentPriceElement = document.getElementById('currentPrice');
            const selectionHint = document.getElementById('selectionHint');
            
            priceDisplay.classList.remove('hidden');
            selectionHint.classList.add('hidden');
            
            if (price === null || price === '-' || price === undefined) {
                currentPriceElement.textContent = '暂无数据';
                currentPriceElement.classList.add('text-gray-400');
            } else {
                currentPriceElement.textContent = price.toFixed(2);
                currentPriceElement.classList.remove('text-gray-400');
            }
        }

        // 隐藏价格
        function hidePrice() {
            const priceDisplay = document.getElementById('priceDisplay');
            const selectionHint = document.getElementById('selectionHint');
            
            priceDisplay.classList.add('hidden');
            selectionHint.classList.remove('hidden');
        }

        // 保存到查询历史
        function saveToHistory(queryData) {
            // 添加时间戳
            queryData.timestamp = new Date().getTime();
            
            // 获取现有历史记录
            let history = JSON.parse(localStorage.getItem('pipeQueryHistory') || '[]');
            
            // 限制历史记录数量为10条
            if (history.length >= 10) {
                history = history.slice(0, 9);
            }
            
            // 添加新记录到开头
            history.unshift(queryData);
            
            // 保存到localStorage
            localStorage.setItem('pipeQueryHistory', JSON.stringify(history));
            
            // 更新历史记录显示
            loadQueryHistory();
        }

        // 加载查询历史
        function loadQueryHistory() {
            const historyList = document.getElementById('historyList');
            const emptyHistoryMsg = document.getElementById('emptyHistoryMsg');
            
            // 获取历史记录
            const history = JSON.parse(localStorage.getItem('pipeQueryHistory') || '[]');
            
            // 清空现有列表
            historyList.innerHTML = '';
            
            // 显示或隐藏空历史消息
            if (history.length === 0) {
                emptyHistoryMsg.classList.remove('hidden');
                historyList.classList.add('hidden');
                return;
            }
            
            // 显示历史记录列表
            emptyHistoryMsg.classList.add('hidden');
            historyList.classList.remove('hidden');
            
            // 添加历史记录项
            history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-all-300';
                historyItem.innerHTML = `
                    <div class="font-medium text-gray-800">
                        ${item.standard} ${item.pipeType} ${item.outerDiameter}
                    </div>
                    <div class="flex flex-wrap gap-2 mt-1 text-sm">
                        <div class="bg-gray-100 px-2 py-0.5 rounded text-gray-600">${item.steelType}</div>
                        <div class="bg-gray-100 px-2 py-0.5 rounded text-gray-600">${item.specification}</div>
                        <div class="bg-gray-100 px-2 py-0.5 rounded text-gray-600">${item.wallThickness}mm</div>
                    </div>
                    <div class="text-xs text-gray-400 mt-2">
                        ${new Date(item.timestamp).toLocaleString()}
                    </div>
                `;
                
                // 添加点击事件 - 同步到左侧选择
                historyItem.addEventListener('click', function() {
                    // 重置所有选择框
                    standardSelect.value = '';
                    pipeTypeSelect.value = '';
                    steelTypeSelect.value = '';
                    outerDiameterSelect.value = '';
                    specificationSelect.value = '';
                    wallThicknessSelect.value = '';
                    
                    // 触发标准类型选择
                    standardSelect.value = item.standard;
                    standardSelect.dispatchEvent(new Event('change'));
                    
                    // 使用setTimeout确保每个选择有足够时间加载下一级选项
                    setTimeout(() => {
                        pipeTypeSelect.value = item.pipeType;
                        pipeTypeSelect.dispatchEvent(new Event('change'));
                        
                        setTimeout(() => {
                            steelTypeSelect.value = item.steelType;
                            steelTypeSelect.dispatchEvent(new Event('change'));
                            
                            setTimeout(() => {
                                outerDiameterSelect.value = item.outerDiameter;
                                outerDiameterSelect.dispatchEvent(new Event('change'));
                                
                                setTimeout(() => {
                                    specificationSelect.value = item.specification;
                                    specificationSelect.dispatchEvent(new Event('change'));
                                    
                                    setTimeout(() => {
                                        wallThicknessSelect.value = item.wallThickness;
                                        wallThicknessSelect.dispatchEvent(new Event('change'));
                                    }, 300);
                                }, 300);
                            }, 300);
                        }, 300);
                    }, 300);
                });
                
                historyList.appendChild(historyItem);
            });
        }

        // 初始化管件查询系统
        function initPipeSystem() {
            // 获取DOM元素
            const standardSelect = document.getElementById('standard');
            const pipeTypeSelect = document.getElementById('pipeType');
            const steelTypeSelect = document.getElementById('steelType');
            const outerDiameterSelect = document.getElementById('outerDiameter');
            const specificationSelect = document.getElementById('specification');
            const wallThicknessSelect = document.getElementById('wallThickness');
            const currentPriceElement = document.getElementById('currentPrice');
            const clearHistoryBtn = document.getElementById('clearHistoryBtn');
            const exportHistoryBtn = document.getElementById('exportHistoryBtn');
            
            // 结果显示元素
            const resStandard = document.getElementById('resStandard');
            const resPipeType = document.getElementById('resPipeType');
            const resSteelType = document.getElementById('resSteelType');
            const resOuterDiameter = document.getElementById('resOuterDiameter');
            const resSpecification = document.getElementById('resSpecification');
            const resWallThickness = document.getElementById('resWallThickness');
            
            // 加载查询历史
            loadQueryHistory();
            
            // 1. 标准类型变化事件
            standardSelect.addEventListener('change', function() {
                const selectedStandard = this.value;
                
                // 更新结果显示
                resStandard.textContent = selectedStandard || '未选择';
                
                // 重置后续选择框
                resetSelect(pipeTypeSelect, '请先选择标准类型');
                resetSelect(steelTypeSelect, '请先选择管件类型');
                resetSelect(outerDiameterSelect, '请先选择钢材类型');
                resetSelect(specificationSelect, '请先选择外径规格');
                resetSelect(wallThicknessSelect, '请先选择规格');
                hidePrice();
                
                // 如果选择了标准类型，填充管件类型选择框
                if (selectedStandard && pipePriceDB[selectedStandard]) {
                    enableSelect(pipeTypeSelect);
                    fillSelectWithKeys(pipeTypeSelect, pipePriceDB[selectedStandard], '请选择管件类型');
                }
            });
            
            // 2. 管件类型变化事件
            pipeTypeSelect.addEventListener('change', function() {
                const selectedStandard = standardSelect.value;
                const selectedPipeType = this.value;
                
                // 更新结果显示
                resPipeType.textContent = selectedPipeType || '未选择';
                
                // 重置后续选择框
                resetSelect(steelTypeSelect, '请先选择管件类型');
                resetSelect(outerDiameterSelect, '请先选择钢材类型');
                resetSelect(specificationSelect, '请先选择外径规格');
                resetSelect(wallThicknessSelect, '请先选择规格');
                hidePrice();
                
                // 获取所有可能的钢材类型
                if (selectedStandard && selectedPipeType && pipePriceDB[selectedStandard][selectedPipeType]) {
                    const steelTypes = new Set();
                    const pipeTypeData = pipePriceDB[selectedStandard][selectedPipeType];
                    
                    // 遍历所有外径规格
                    Object.values(pipeTypeData).forEach(outerDiameterData => {
                        // 遍历所有规格（有缝/无缝）
                        Object.values(outerDiameterData).forEach(specData => {
                            // 遍历所有壁厚
                            Object.values(specData).forEach(thicknessData => {
                                // 收集钢材类型
                                Object.keys(thicknessData).forEach(steelType => {
                                    steelTypes.add(steelType);
                                });
                            });
                        });
                    });
                    
                    // 填充钢材类型选择框
                    if (steelTypes.size > 0) {
                        enableSelect(steelTypeSelect);
                        steelTypeSelect.innerHTML = '<option value="">请选择钢材类型</option>';
                        Array.from(steelTypes).forEach(type => {
                            const option = document.createElement('option');
                            option.value = type;
                            option.textContent = type;
                            steelTypeSelect.appendChild(option);
                        });
                    }
                }
            });
            
            // 3. 钢材类型变化事件
            steelTypeSelect.addEventListener('change', function() {
                const selectedStandard = standardSelect.value;
                const selectedPipeType = pipeTypeSelect.value;
                const selectedSteelType = this.value;
                
                // 更新结果显示
                resSteelType.textContent = selectedSteelType || '未选择';
                
                // 重置后续选择框
                resetSelect(outerDiameterSelect, '请先选择钢材类型');
                resetSelect(specificationSelect, '请先选择外径规格');
                resetSelect(wallThicknessSelect, '请先选择规格');
                hidePrice();
                
                // 筛选包含所选钢材类型的外径规格
                if (selectedStandard && selectedPipeType && selectedSteelType && 
                    pipePriceDB[selectedStandard][selectedPipeType]) {
                    
                    const validOuterDiameters = [];
                    const pipeTypeData = pipePriceDB[selectedStandard][selectedPipeType];
                    
                    // 遍历所有外径规格
                    Object.entries(pipeTypeData).forEach(([outerDiameter, outerDiameterData]) => {
                        // 检查该外径规格是否有包含所选钢材类型的记录
                        let hasValidData = false;
                        
                        // 遍历所有规格（有缝/无缝）
                        Object.values(outerDiameterData).forEach(specData => {
                            // 遍历所有壁厚
                            Object.values(specData).forEach(thicknessData => {
                                if (thicknessData[selectedSteelType] !== undefined) {
                                    hasValidData = true;
                                }
                            });
                        });
                        
                        if (hasValidData) {
                            validOuterDiameters.push(outerDiameter);
                        }
                    });
                    
                    // 填充外径规格选择框
                    if (validOuterDiameters.length > 0) {
                        enableSelect(outerDiameterSelect);
                        outerDiameterSelect.innerHTML = '<option value="">请选择外径规格</option>';
                        validOuterDiameters.forEach(diameter => {
                            const option = document.createElement('option');
                            option.value = diameter;
                            option.textContent = diameter;
                            outerDiameterSelect.appendChild(option);
                        });
                    }
                }
            });
            
            // 4. 外径规格变化事件
            outerDiameterSelect.addEventListener('change', function() {
                const selectedStandard = standardSelect.value;
                const selectedPipeType = pipeTypeSelect.value;
                const selectedSteelType = steelTypeSelect.value;
                const selectedOuterDiameter = this.value;
                
                // 更新结果显示
                resOuterDiameter.textContent = selectedOuterDiameter || '未选择';
                
                // 重置后续选择框
                resetSelect(specificationSelect, '请先选择外径规格');
                resetSelect(wallThicknessSelect, '请先选择规格');
                hidePrice();
                
                // 筛选包含所选钢材类型的规格（有缝/无缝）
                if (selectedStandard && selectedPipeType && selectedSteelType && selectedOuterDiameter &&
                    pipePriceDB[selectedStandard][selectedPipeType][selectedOuterDiameter]) {
                    
                    const validSpecifications = [];
                    const outerDiameterData = pipePriceDB[selectedStandard][selectedPipeType][selectedOuterDiameter];
                    
                    // 遍历所有规格
                    Object.entries(outerDiameterData).forEach(([spec, specData]) => {
                        // 检查该规格是否有包含所选钢材类型的记录
                        let hasValidData = false;
                        
                        // 遍历所有壁厚
                        Object.values(specData).forEach(thicknessData => {
                            if (thicknessData[selectedSteelType] !== undefined) {
                                hasValidData = true;
                            }
                        });
                        
                        if (hasValidData) {
                            validSpecifications.push(spec);
                        }
                    });
                    
                    // 填充规格选择框
                    if (validSpecifications.length > 0) {
                        enableSelect(specificationSelect);
                        specificationSelect.innerHTML = '<option value="">请选择规格</option>';
                        validSpecifications.forEach(spec => {
                            const option = document.createElement('option');
                            option.value = spec;
                            option.textContent = spec;
                            specificationSelect.appendChild(option);
                        });
                    }
                }
            });
            
            // 5. 规格变化事件
            specificationSelect.addEventListener('change', function() {
                const selectedStandard = standardSelect.value;
                const selectedPipeType = pipeTypeSelect.value;
                const selectedSteelType = steelTypeSelect.value;
                const selectedOuterDiameter = outerDiameterSelect.value;
                const selectedSpecification = this.value;
                
                // 更新结果显示
                resSpecification.textContent = selectedSpecification || '未选择';
                
                // 重置后续选择框
                resetSelect(wallThicknessSelect, '请先选择规格');
                hidePrice();
                
                // 筛选包含所选钢材类型的壁厚
                if (selectedStandard && selectedPipeType && selectedSteelType && 
                    selectedOuterDiameter && selectedSpecification &&
                    pipePriceDB[selectedStandard][selectedPipeType][selectedOuterDiameter][selectedSpecification]) {
                    
                    const validWallThicknesses = [];
                    const specData = pipePriceDB[selectedStandard][selectedPipeType][selectedOuterDiameter][selectedSpecification];
                    
                    // 遍历所有壁厚
                    Object.entries(specData).forEach(([thickness, thicknessData]) => {
                        if (thicknessData[selectedSteelType] !== undefined) {
                            validWallThicknesses.push(thickness);
                        }
                    });
                    
                    // 填充壁厚选择框
                    if (validWallThicknesses.length > 0) {
                        enableSelect(wallThicknessSelect);
                        wallThicknessSelect.innerHTML = '<option value="">请选择壁厚</option>';
                        validWallThicknesses.forEach(thickness => {
                            const option = document.createElement('option');
                            option.value = thickness;
                            option.textContent = thickness;
                            wallThicknessSelect.appendChild(option);
                        });
                    }
                }
            });
            
            // 6. 壁厚变化事件
            wallThicknessSelect.addEventListener('change', function() {
                const selectedStandard = standardSelect.value;
                const selectedPipeType = pipeTypeSelect.value;
                const selectedSteelType = steelTypeSelect.value;
                const selectedOuterDiameter = outerDiameterSelect.value;
                const selectedSpecification = specificationSelect.value;
                const selectedWallThickness = this.value;
                
                // 更新结果显示
                resWallThickness.textContent = selectedWallThickness ? selectedWallThickness + ' mm' : '未选择';
                
                // 如果所有选项都已选择，显示价格
                if (selectedStandard && selectedPipeType && selectedSteelType && 
                    selectedOuterDiameter && selectedSpecification && selectedWallThickness) {
                    // 获取价格
                    const price = pipePriceDB[selectedStandard][selectedPipeType][selectedOuterDiameter]
                        [selectedSpecification][selectedWallThickness][selectedSteelType];
                    
                    // 显示价格
                    showPrice(price);
                    
                    // 保存到查询历史
                    saveToHistory({
                        standard: selectedStandard,
                        pipeType: selectedPipeType,
                        steelType: selectedSteelType,
                        outerDiameter: selectedOuterDiameter,
                        specification: selectedSpecification,
                        wallThickness: selectedWallThickness,
                        price: price
                    });
                }
            });
            
            // 清空历史记录按钮事件
            clearHistoryBtn.addEventListener('click', function() {
                if (confirm('确定要清空所有查询历史吗？')) {
                    localStorage.removeItem('pipeQueryHistory');
                    loadQueryHistory();
                }
            });
            
            // 导出历史记录按钮事件
            exportHistoryBtn.addEventListener('click', function() {
                const history = JSON.parse(localStorage.getItem('pipeQueryHistory') || '[]');
                if (history.length === 0) {
                    alert('没有查询历史可导出');
                    return;
                }
                
                // 转换为CSV格式
                let csvContent = "标准类型,管件类型,钢材类型,外径规格,规格,壁厚,价格,查询时间\n";
                history.forEach(item => {
                    csvContent += `${item.standard},${item.pipeType},${item.steelType},${item.outerDiameter},${item.specification},${item.wallThickness},${item.price || ''},${new Date(item.timestamp).toLocaleString()}\n`;
                });
                
                // 创建下载链接
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.setAttribute('href', url);
                a.setAttribute('download', `管件查询历史_${new Date().toLocaleDateString()}.csv`);
                a.style.visibility = 'hidden';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });
            
            // 导出当前结果按钮事件
            document.getElementById('exportCurrentBtn').addEventListener('click', function() {
                const selectedStandard = standardSelect.value;
                const selectedPipeType = pipeTypeSelect.value;
                const selectedSteelType = steelTypeSelect.value;
                const selectedOuterDiameter = outerDiameterSelect.value;
                const selectedSpecification = specificationSelect.value;
                const selectedWallThickness = wallThicknessSelect.value;
                const price = currentPriceElement.textContent;
                
                if (!selectedStandard || !selectedPipeType || !selectedSteelType || 
                    !selectedOuterDiameter || !selectedSpecification || !selectedWallThickness) {
                    alert('请完成所有参数选择');
                    return;
                }
                
                // 转换为CSV格式
                let csvContent = "标准类型,管件类型,钢材类型,外径规格,规格,壁厚,价格\n";
                csvContent += `${selectedStandard},${selectedPipeType},${selectedSteelType},${selectedOuterDiameter},${selectedSpecification},${selectedWallThickness},${price}\n`;
                
                // 创建下载链接
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.setAttribute('href', url);
                a.setAttribute('download', `管件查询结果_${new Date().toLocaleDateString()}.csv`);
                a.style.visibility = 'hidden';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });
            
            // 系统帮助按钮事件
            document.getElementById('systemHelpBtn').addEventListener('click', function() {
                alert('系统使用帮助：\n\n1. 六级联动查询：标准类型 → 管件类型 → 钢材类型 → 外径规格 → 规格 → 壁厚\n2. 历史记录：自动保存查询记录，点击可快速加载历史查询\n3. 数据导出：支持导出当前查询结果和历史记录');
            });
        }

        // 页面加载完成后初始化系统
        document.addEventListener('DOMContentLoaded', initPipeSystem);
    </script>
</body>
</html>
